

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Modelos Lineales Generalizados (GML) &#8212; An√°lisis Geoespacial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '04_GLMPhyton';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Visualizaci√≥n de datos discretos" href="06_Coropleta.html" />
    <link rel="prev" title="Patr√≥n de puntos" href="03_PointPattern.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="An√°lisis Geoespacial - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="An√°lisis Geoespacial - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    <no title>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00_Ambiente.html">Ambiente computacional</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_DatosEspaciales.html">An√°lisis Geoespacial</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_Mapping.html">El arte de hacer mapas</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_PointPattern.html">Patr√≥n de puntos</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Modelos Lineales Generalizados (GML)</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_Coropleta.html">Visualizaci√≥n de datos discretos</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_MatrizCorrelacion.html">Matriz espacial</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_ClusterEspacial.html">Cluster espacial</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_SpatialRegression.html">Regresi√≥n Espacial</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_SAR.html">Modelos de regresi√≥n para dependencia espacial tipo SAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_CAR.html">Modelos de regresi√≥n para dependencia espacial tipo CAR</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_Jerarquicos.html">Modelos de Regresi√≥n para Heterogeneidad Espacial</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_MGWR.html">Regresi√≥n Ponderada Geogr√°ficamente (GWR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_Kriging.html">Kriging con Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_GP.html">Procesos Gaussianos con Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_GP.html">Procesos Gaussianos con R</a></li>
<li class="toctree-l1"><a class="reference internal" href="17_LGCP.html">Modelo GLM de Poisson no-homog√©neo</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_DB.html">Bases de datos geoespaciales</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/edieraristizabal/Libro_AnalisisGeoespacial" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/edieraristizabal/Libro_AnalisisGeoespacial/issues/new?title=Issue%20on%20page%20%2F04_GLMPhyton.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/04_GLMPhyton.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelos Lineales Generalizados (GML)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-logistica">Modelo de Regresi√≥n Log√≠stica</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-con-statsmodels">Ejemplo con Statsmodels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-con-sklearn">Ejemplo con Sklearn</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-poisson">Modelo de Poisson</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-1-de-un-glm-de-poisson-homogeneo">Ejemplo 1 de un GLM de Poisson homog√©neo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-2-de-un-glm-de-poisson-homogeneo">Ejemplo 2 de un GLM de Poisson homog√©neo</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-binomial-negativo">Modelo Binomial Negativo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo">Ejemplo</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-ceros-inflados">Modelo de Ceros Inflados</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Ejemplo</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p style="font-size:11px;"><em><strong>Cr√©ditos</strong>: El contenido de este cuaderno ha sido tomado de varias fuentes, pero especialmente de <a href="https://github.com/Mark-Kramer/Case-Studies-Python/blob/master/09.ipynb">Mar Kramer</a> y <a href="https://stats.oarc.ucla.edu/r/dae/poisson-regression/">UCLA</a>. El compilador se disculpa por cualquier omisi√≥n involuntaria y estar√≠a encantado de agregar un reconocimiento.</em></p><section class="tex2jax_ignore mathjax_ignore" id="modelos-lineales-generalizados-gml">
<h1>Modelos Lineales Generalizados (GML)<a class="headerlink" href="#modelos-lineales-generalizados-gml" title="Permalink to this heading">#</a></h1>
<p>Los Modelos Lineales Generalizados (GLM) son una extensi√≥n de los modelos lineales cl√°sicos (como la regresi√≥n lineal) que permiten modelar una variedad m√°s amplia de tipos de datos, incluyendo aquellos que no siguen una distribuci√≥n normal. Estos modelos son especialmente √∫tiles cuando la variable dependiente sigue una distribuci√≥n distinta, como una distribuci√≥n binomial (en el caso de variables de respuesta dicot√≥micas), una distribuci√≥n de Poisson (para conteos), o una distribuci√≥n gamma (para variables continuas positivas).</p>
<p>Un GLM est√° compuesto por tres elementos esenciales:</p>
<ul class="simple">
<li><p>Funci√≥n de enlace (ùëî(‚ãÖ)): Establece la relaci√≥n entre la media de la variable dependiente ùëå y los predictores lineales.</p></li>
<li><p>Distribuci√≥n de la variable dependiente: La variable dependiente ùëå sigue una distribuci√≥n dentro de la familia exponencial (por ejemplo, normal, binomial, Poisson, etc.).</p></li>
<li><p>Predictores lineales: La relaci√≥n entre los predictores ùëã1,ùëã2,‚Ä¶,ùëãùëù y la variable dependiente se describe mediante una combinaci√≥n lineal de los mismos.</p></li>
</ul>
<p>La forma general de un GLM se puede expresar como:</p>
<p><span class="math notranslate nohighlight">\(
g(\mathbb{E}[Y_i]) = \beta_0 + \beta_1 X_{i1} + \beta_2 X_{i2} + \dots + \beta_p X_{ip}
\)</span></p>
<p>Donde:</p>
<ul class="simple">
<li><p>ùëåùëñ es la variable dependiente para la ùëñ-√©sima observaci√≥n.</p></li>
<li><p>ùëî(ùê∏[ùëåùëñ]) es la funci√≥n de enlace aplicada a la esperanza de ùëåùëñ.</p></li>
<li><p>ùõΩ0 es el intercepto y ùõΩ1,ùõΩ2,‚Ä¶ùõΩùëù son los coeficientes de los predictores ùëã1,ùëã2,‚Ä¶,ùëãùëù.</p></li>
<li><p>ùëî(‚ãÖ) es la funci√≥n de enlace, que transforma la media de ùëåùëñ en un valor que tiene una forma lineal respecto a los predictores.</p></li>
</ul>
<p>Dependiendo del tipo de variable dependiente, se utilizan diferentes distribuciones dentro de la familia exponencial:</p>
<section id="modelo-de-regresion-logistica">
<h2>Modelo de Regresi√≥n Log√≠stica<a class="headerlink" href="#modelo-de-regresion-logistica" title="Permalink to this heading">#</a></h2>
<p>La regresi√≥n log√≠stica es un modelo lineal generalizado (GLM, por sus siglas en ingl√©s) utilizado para modelar variables respuesta binarias. A diferencia de la regresi√≥n lineal cl√°sica, donde la variable dependiente es continua, en la regresi√≥n log√≠stica la respuesta ùëå toma √∫nicamente dos valores posibles, usualmente codificados como 0 y 1. Este m√©todo es ampliamente utilizado en an√°lisis de eventos geoespaciales, como la ocurrencia o no de deslizamientos, incendios, inundaciones, entre otros.</p>
<p>Mientras la regresi√≥n binomial modela proporciones o conteos de √©xitos en un n√∫mero fijo de ensayos ùëõ, la regresi√≥n log√≠stica corresponde a un caso especial del modelo binomial con ùëõ=1.</p>
<p>La funci√≥n de distribuci√≥n acumulada de la distribuci√≥n log√≠stica est√° definida como:</p>
<div class="math notranslate nohighlight">
\[
F(x; \mu, s) = \frac{1}{1 + \exp\left(-\frac{x - \mu}{s}\right)}
\]</div>
<p>donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(( x \in \mathbb{R})\)</span> es la variable aleatoria continua,</p></li>
<li><p><span class="math notranslate nohighlight">\(( \mu \in \mathbb{R})\)</span> es el par√°metro de <strong>ubicaci√≥n</strong> (media y punto de inflexi√≥n),</p></li>
<li><p><span class="math notranslate nohighlight">\(( s &gt; 0 )\)</span> es el par√°metro de <strong>escala</strong>, que determina la pendiente o dispersi√≥n de la curva.</p></li>
</ul>
<p>Esta funci√≥n tiene forma de sigmoide y es la base del modelo de regresi√≥n log√≠stica. El valor de <span class="math notranslate nohighlight">\(( F(x; \mu, s) )\)</span> representa la probabilidad acumulada hasta el punto <span class="math notranslate nohighlight">\(( x )\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">logistic</span>

<span class="c1"># Rango de valores de x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Conjuntos de par√°metros (mu, s)</span>
<span class="n">param_sets</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>     <span class="c1"># est√°ndar</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>   <span class="c1"># m√°s empinada</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>     <span class="c1"># m√°s dispersa</span>
    <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>    <span class="c1"># desplazada a la izquierda</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>     <span class="c1"># desplazada a la derecha</span>
<span class="p">]</span>

<span class="c1"># Colores para la visualizaci√≥n</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>

<span class="c1"># Graficar CDF para cada conjunto de par√°metros</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">param_sets</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">logistic</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$\mu=</span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s1">,\ s=</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Funciones de distribuci√≥n log√≠stica (CDF) con diferentes par√°metros&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$F(x)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c3557ac28b6569d9990620691749d55f74ea6e11817c021708f0fa76f33635f3.png" src="_images/c3557ac28b6569d9990620691749d55f74ea6e11817c021708f0fa76f33635f3.png" />
</div>
</div>
<p>Cuando ùë† disminuye (por ejemplo,ùë†=0.5), la curva se vuelve m√°s empinada: los cambios en ùë• producen variaciones m√°s abruptas en la probabilidad.</p>
<p>Cuando ùë† aumenta (por ejemplo, ùë†=2), la curva se aplana: los cambios en ùë• tienen menor impacto inmediato en la probabilidad.</p>
<p>Cuando ùúá se desplaza (por ejemplo, ùúá=‚àí3 o ùúá=3), se mueve el punto de inflexi√≥n de la sigmoide hacia la izquierda o derecha, sin cambiar la forma de la curva.</p>
<p>Sea <span class="math notranslate nohighlight">\(Y_i \in \{0,1\}\)</span> una variable aleatoria binaria que representa la ocurrencia de un evento en la unidad <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>Se modela la probabilidad condicional <span class="math notranslate nohighlight">\(\pi_i = \mathbb{P}(Y_i = 1 \mid \mathbf{x}_i)\)</span> como:</p>
<div class="math notranslate nohighlight">
\[
\pi_i = \frac{1}{1 + \exp(-\eta_i)} = \text{logit}^{-1}(\eta_i)
\]</div>
<p>donde el predictor lineal es:</p>
<div class="math notranslate nohighlight">
\[
\eta_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \dots + \beta_p x_{ip} = \mathbf{x}_i^\top \boldsymbol{\beta}
\]</div>
<p>y la funci√≥n de enlace logit es:</p>
<div class="math notranslate nohighlight">
\[
\text{logit}(\pi_i) = \log\left(\frac{\pi_i}{1 - \pi_i}\right) = \eta_i
\]</div>
<p>El modelo asume una distribuci√≥n Bernoulli para la respuesta:</p>
<div class="math notranslate nohighlight">
\[
Y_i \sim \text{Bernoulli}(\pi_i)
\]</div>
<p>La funci√≥n log-verosimilitud para los <span class="math notranslate nohighlight">\(n\)</span> datos observados es:</p>
<div class="math notranslate nohighlight">
\[
\ell(\boldsymbol{\beta}) = \sum_{i=1}^{n} \left[ y_i \log(\pi_i) + (1 - y_i)\log(1 - \pi_i) \right]
\]</div>
<p>donde <span class="math notranslate nohighlight">\(\pi_i = \frac{1}{1 + \exp(-\mathbf{x}_i^\top \boldsymbol{\beta})}\)</span>.</p>
<p>Cada coeficiente ùõΩùëó se interpreta como el cambio en el logit (log-odds) de la probabilidad de √©xito por unidad de incremento en ùë•ùëó, manteniendo las dem√°s variables constantes. Alternativamente, exp(ùõΩùëó) representa el odds ratio, es decir, el factor multiplicativo en las probabilidades al incrementar en una unidad
ùë•ùëó.
$<span class="math notranslate nohighlight">\(
\frac{\partial \log\left( \frac{\pi_i}{1 - \pi_i} \right)}{\partial x_j} = \beta_j
\)</span>$</p>
<p>Y el <strong>odds ratio</strong> se obtiene como:</p>
<div class="math notranslate nohighlight">
\[
\text{OR}_j = \exp(\beta_j)
\]</div>
<p>Como ventajas se tiene:</p>
<ul class="simple">
<li><p>Flexibilidad: Permite modelar probabilidades entre 0 y 1 mediante una funci√≥n sigmoide.</p></li>
<li><p>Interpretabilidad: Los odds ratios son intuitivos y √∫tiles para la toma de decisiones.</p></li>
<li><p>Ampliamente implementado: Disponible en casi todos los lenguajes estad√≠sticos (R, Python, STATA, etc.).</p></li>
<li><p>Generalizable: Es un caso particular del marco de los modelos lineales generalizados, lo que permite su extensi√≥n a modelos multivariados, espaciales y jer√°rquicos.</p></li>
</ul>
<p>Como desventajas se registran:</p>
<ul class="simple">
<li><p>No modela directamente la probabilidad si hay correlaci√≥n espacial o temporal, lo cual puede llevar a errores de inferencia.</p></li>
<li><p>Sensibilidad a valores at√≠picos: Aunque m√°s robusta que la regresi√≥n lineal, sigue siendo afectada por outliers en las covariables.</p></li>
<li><p>Supone independencia: No es adecuada si hay dependencia espacial o temporal entre las observaciones, lo cual es com√∫n en datos geoespaciales.</p></li>
<li><p>Relaci√≥n lineal en el logit: Si la relaci√≥n real no es lineal en el logit, el modelo puede no ajustarse bien.</p></li>
</ul>
<p>Sin embargo, debido a la naturaleza espacial de estos fen√≥menos, es frecuente combinar la regresi√≥n log√≠stica con modelos que incorporen autocorrelaci√≥n espacial (como modelos SAR o CAR) o adoptar enfoques de regresi√≥n geogr√°ficamente ponderada o modelos jer√°rquicos bayesianos.</p>
<section id="ejemplo-con-statsmodels">
<h3>Ejemplo con Statsmodels<a class="headerlink" href="#ejemplo-con-statsmodels" title="Permalink to this heading">#</a></h3>
<p>Simulamos una variable binaria y como respuesta a dos covariables x1 (continua) y x2 (binaria).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>

<span class="c1"># Covariables</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># Coeficientes verdaderos</span>
<span class="n">beta_0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
<span class="n">beta_1</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">beta_2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>

<span class="c1"># Probabilidad con funci√≥n log√≠stica</span>
<span class="n">lin_pred</span> <span class="o">=</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="n">beta_1</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">beta_2</span> <span class="o">*</span> <span class="n">x2</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">lin_pred</span><span class="p">))</span>

<span class="c1"># Variable respuesta binaria</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="c1"># DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">x1</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">x2</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Agregar constante</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">]])</span>  <span class="c1"># a√±ade la constante (intercepto)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>

<span class="c1"># Ajuste del modelo</span>
<span class="n">modelo</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Logit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">modelo</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.456092
         Iterations 6
                           Logit Regression Results                           
==============================================================================
Dep. Variable:                      y   No. Observations:                  500
Model:                          Logit   Df Residuals:                      497
Method:                           MLE   Df Model:                            2
Date:                Sat, 14 Jun 2025   Pseudo R-squ.:                  0.2995
Time:                        14:58:06   Log-Likelihood:                -228.05
converged:                       True   LL-Null:                       -325.54
Covariance Type:            nonrobust   LLR p-value:                 4.555e-43
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const         -0.2504      0.153     -1.638      0.101      -0.550       0.049
x1             1.6643      0.164     10.154      0.000       1.343       1.986
x2            -1.2812      0.242     -5.285      0.000      -1.756      -0.806
==============================================================================
</pre></div>
</div>
</div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Elemento</p></th>
<th class="head"><p>Interpretaci√≥n</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Dep.</span> <span class="pre">Variable</span></code></p></td>
<td><p>Variable dependiente modelada (respuesta binaria, por ejemplo, <code class="docutils literal notranslate"><span class="pre">y</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">No.</span> <span class="pre">Observations</span></code></p></td>
<td><p>N√∫mero total de observaciones utilizadas para ajustar el modelo.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Model</span></code></p></td>
<td><p>Tipo de modelo ajustado, en este caso <code class="docutils literal notranslate"><span class="pre">Logit</span></code>, que indica una regresi√≥n log√≠stica.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Method</span></code></p></td>
<td><p>M√©todo de estimaci√≥n utilizado, t√≠picamente <code class="docutils literal notranslate"><span class="pre">MLE</span></code> (M√°xima Verosimilitud).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Df</span> <span class="pre">Residuals</span></code></p></td>
<td><p>Grados de libertad residuales: n√∫mero de observaciones menos el n√∫mero de par√°metros estimados.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Df</span> <span class="pre">Model</span></code></p></td>
<td><p>Grados de libertad del modelo: n√∫mero de predictores (sin incluir la constante).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Pseudo</span> <span class="pre">R-squ.</span></code></p></td>
<td><p>Pseudo-R¬≤, una medida del poder explicativo del modelo. No debe interpretarse como un R¬≤ cl√°sico, pero valores m√°s altos indican mejor ajuste relativo.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Log-Likelihood</span></code></p></td>
<td><p>Logaritmo de la verosimilitud del modelo ajustado; m√°s cercano a cero es mejor.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LL-Null</span></code></p></td>
<td><p>Log-verosimilitud del modelo nulo (modelo sin predictores, solo constante).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">LLR</span> <span class="pre">p-value</span></code></p></td>
<td><p>Valor p del test de raz√≥n de verosimilitud. Eval√∫a si el modelo completo mejora significativamente con respecto al modelo nulo. Un valor peque√±o (p &lt; 0.05) indica que el modelo es estad√≠sticamente significativo.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">converged</span></code></p></td>
<td><p>Indica si el proceso de optimizaci√≥n num√©rica del modelo ha convergido correctamente.</p></td>
</tr>
</tbody>
</table>
<hr class="docutils" />
<p>La siguiente tabla presenta los par√°metros estimados para el modelo log√≠stico:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Columna</p></th>
<th class="head"><p>Interpretaci√≥n</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">coef</span></code></p></td>
<td><p>Estimaci√≥n del coeficiente <span class="math notranslate nohighlight">\(( \beta_j )\)</span>. Representa el cambio en el <strong>logit</strong> (logaritmo del odds) de la variable respuesta por cada unidad de cambio en la covariable correspondiente.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">std</span> <span class="pre">err</span></code></p></td>
<td><p>Error est√°ndar de la estimaci√≥n del coeficiente. Se usa para construir intervalos de confianza y calcular el estad√≠stico z.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">z</span></code></p></td>
<td><p>Estad√≠stico z, calculado como <span class="math notranslate nohighlight">\(( \beta_j / \text{SE} )\)</span>. Sirve para evaluar la significancia del coeficiente bajo la hip√≥tesis nula <span class="math notranslate nohighlight">\(( H_0: \beta_j = 0 )\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>`P&gt;</p></td>
<td><p>z</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">[0.025</span>&#160; <span class="pre">0.975]</span></code></p></td>
<td><p>Intervalo de confianza del 95% para el coeficiente <span class="math notranslate nohighlight">\(( \beta_j )\)</span>. Si el intervalo no contiene cero, se considera que el coeficiente es estad√≠sticamente significativo.</p></td>
</tr>
</tbody>
</table>
<hr class="docutils" />
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(( \beta_j &gt; 0 )\)</span>: A mayor valor de la covariable <span class="math notranslate nohighlight">\(( x_j )\)</span>, aumenta el <strong>log-odds</strong> de que la variable dependiente sea 1.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(( \beta_j &lt; 0 )\)</span>: A mayor valor de <span class="math notranslate nohighlight">\(( x_j )\)</span>, disminuye el log-odds de √©xito.</p></li>
<li><p>Para obtener el <strong>odds ratio</strong>, se aplica: <span class="math notranslate nohighlight">\([\text{OR}_j = \exp(\beta_j)]\)</span><br />
Este valor representa cu√°nto se multiplica el odds por cada unidad adicional de <span class="math notranslate nohighlight">\(( x_j )\)</span>, manteniendo constante el resto de covariables.</p></li>
</ul>
<hr class="docutils" />
<p>x1 = 2.0542: Por cada unidad adicional en x1, el log-odds de que ùë¶=1 aumenta en 2.05. Es decir, el odds se multiplica por exp(2.0542)‚âà7.8.</p>
<p>x2 = -1.0762: Si x2 pasa de 0 a 1 (es binaria), el log-odds de √©xito disminuye en 1.08. El odds se reduce por un factor de exp‚Å°(‚àí1.0762)‚âà0.34.</p>
<p>El valor LLR p-value: 3.591e-60 indica que el modelo con predictores explica significativamente m√°s que el modelo nulo. Esto es evidencia a favor del modelo propuesto.</p>
</section>
<section id="ejemplo-con-sklearn">
<h3>Ejemplo con Sklearn<a class="headerlink" href="#ejemplo-con-sklearn" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">roc_auc_score</span>
</pre></div>
</div>
</div>
</div>
<p>Simulamos dos covariables ùë•1 y ùë•2, y una respuesta binaria ùë¶ con base en un modelo log√≠stico.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Variables predictoras</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Coeficientes reales</span>
<span class="n">beta_0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">beta_1</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">beta_2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>

<span class="c1"># Lineal predictor</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="n">beta_1</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">beta_2</span> <span class="o">*</span> <span class="n">x2</span>

<span class="c1"># Probabilidad con funci√≥n log√≠stica</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">eta</span><span class="p">))</span>

<span class="c1"># Variable binaria (respuesta)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="c1"># Crear DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">x1</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">:</span> <span class="n">x2</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Modelo log√≠stico</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="c1"># Coeficientes estimados</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Intercepto:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coeficientes:&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercepto: [-1.2763089]
Coeficientes: [[ 2.19119924 -1.47935977]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predicciones</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">]])</span>
<span class="n">y_prob</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">]])[:,</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#probabilidad del si</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Matriz de confusi√≥n</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matriz de confusi√≥n:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="c1"># M√©tricas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reporte de clasificaci√≥n:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="c1"># AUC y curva ROC</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">y_prob</span><span class="p">)</span>
<span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">y_prob</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;AUC = </span><span class="si">{</span><span class="n">auc</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Falso positivo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Verdadero positivo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matriz de confusi√≥n:
[[866  17]
 [ 53  64]]

Reporte de clasificaci√≥n:
              precision    recall  f1-score   support

           0       0.94      0.98      0.96       883
           1       0.79      0.55      0.65       117

    accuracy                           0.93      1000
   macro avg       0.87      0.76      0.80      1000
weighted avg       0.92      0.93      0.92      1000
</pre></div>
</div>
<img alt="_images/f09c1547c22192c50ca498e28ceef063157ae8eda4180e13d35700dc6b9e161c.png" src="_images/f09c1547c22192c50ca498e28ceef063157ae8eda4180e13d35700dc6b9e161c.png" />
</div>
</div>
</section>
</section>
<section id="modelo-de-poisson">
<h2>Modelo de Poisson<a class="headerlink" href="#modelo-de-poisson" title="Permalink to this heading">#</a></h2>
<p>La distribuci√≥n de Poisson se utiliza debido a su adecuaci√≥n para modelar datos de conteo no negativos (<span class="math notranslate nohighlight">\(ùëå_ùëñ\)</span>=0,1,2,‚Ä¶) y su relaci√≥n con procesos que cuentan la ocurrencia de eventos en el espacio. La distribuci√≥n de Poisson describe la probabilidad de que un n√∫mero de eventos <span class="math notranslate nohighlight">\(ùëå_ùëñ\)</span> ocurra en un intervalo de tiempo o una regi√≥n espacial dada, si esos eventos suceden con una tasa constante <span class="math notranslate nohighlight">\(ùúÜ_ùëñ\)</span>:</p>
<div class="math notranslate nohighlight">
\[
P(Y_i = y_i) = \frac{\lambda_i^{y_i} e^{-\lambda_i}}{y_i!}, \quad y_i = 0, 1, 2, \ldots
\]</div>
<p>donde: <span class="math notranslate nohighlight">\(ùúÜ_ùëñ\)</span>: tasa o intensidad esperada del n√∫mero de eventos en la regi√≥n, <span class="math notranslate nohighlight">\(ùëñ\)</span>, <span class="math notranslate nohighlight">\(ùë¶_ùëñ\)</span>: n√∫mero observado de eventos en la regi√≥n <span class="math notranslate nohighlight">\(ùëñ\)</span>.</p>
<p>Los Modelos Lineales Generalizados (GLM) son modelos en los que las variables de respuesta siguen una distribuci√≥n distinta a la distribuci√≥n normal. El modelo lineal generalizado de Poisson se especifica de la siguiente manera:</p>
<div class="math notranslate nohighlight">
\[
\lambda_i = \mathbb{E}[Y_i] = e^{\eta_i}
\]</div>
<p>donde:</p>
<div class="math notranslate nohighlight">
\[
\eta_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \cdots + \beta_p x_{ip}
\]</div>
<p>y <span class="math notranslate nohighlight">\(ùúÇ_ùëñ\)</span> es la parte lineal del modelo que depende de las covariables <span class="math notranslate nohighlight">\(ùë•_{ùëñj}\)</span> y de los par√°metros <span class="math notranslate nohighlight">\(ùõΩ_ùëó\)</span> (para <span class="math notranslate nohighlight">\(ùëó=0,1,‚Ä¶,ùëù\)</span>. En los modelos de Regresi√≥n de Poisson, las variables predictoras o explicativas pueden ser una mezcla de valores num√©ricos o categ√≥ricos.</p>
<p>En el modelo de Poisson, la funci√≥n de enlace que relaciona la media <span class="math notranslate nohighlight">\(ùúÜ_ùëñ\)</span> con la parte lineal <span class="math notranslate nohighlight">\(ùúÇ_ùëñ\)</span> es el logaritmo natural. Es decir, la funci√≥n de enlace es:</p>
<div class="math notranslate nohighlight">
\[
\eta_i = \log(\lambda_i)
\]</div>
<p>De esta forma, la media de la distribuci√≥n de Poisson se relaciona exponencialmente con la combinaci√≥n lineal de las covariables:</p>
<div class="math notranslate nohighlight">
\[
\lambda_i = e^{\beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \cdots + \beta_p x_{ip}}
\]</div>
<p>Esta forma asegura que la intensidad <span class="math notranslate nohighlight">\(ùúÜ_ùëñ\)</span> siempre ser√° positiva, como es necesario en una distribuci√≥n de Poisson.</p>
<p>Los coeficientes se calculan utilizando m√©todos como la Estimaci√≥n de M√°xima Verosimilitud (MLE) o la cuasi-verosimilitud m√°xima.</p>
<p>La distribuci√≥n de Poisson puede ser considerada como el l√≠mite de una distribuci√≥n binomial. La distribuci√≥n binomial modela el n√∫mero de √©xitos en un n√∫mero fijo de ensayos independientes. Si el n√∫mero de ensayos es muy grande, pero la probabilidad de √©xito en cada ensayo es muy baja (es decir, si los eventos son raros), la distribuci√≥n de Poisson resulta ser una muy buena aproximaci√≥n para modelar el n√∫mero total de √©xitos. Mientras que la distribuci√≥n de Poisson se usa, entonces, para modelar situaciones en las que estamos contando eventos raros que ocurren a lo largo de un intervalo (de tiempo, espacio, etc.). Por ejemplo, la cantidad de accidentes de tr√°fico en un cruce por d√≠a, o el n√∫mero de llamadas que llegan a un centro de emergencias por minuto.</p>
<p>En el contexto de un modelo de Poisson, como los Modelos Lineales Generalizados de Poisson (GLM de Poisson) para an√°lisis espacial, los t√©rminos <strong>sobredispersi√≥n</strong> y <strong>subdispersi√≥n</strong> se refieren a la relaci√≥n entre la varianza y la media de los datos observados, y c√≥mo esta relaci√≥n se ajusta a las expectativas de la distribuci√≥n de Poisson. Estos conceptos son cruciales porque la distribuci√≥n de Poisson tiene una caracter√≠stica espec√≠fica: la media y la varianza son iguales. Sin embargo, en la pr√°ctica, los datos espaciales frecuentemente presentan patrones que difieren de esta suposici√≥n, lo que da lugar a la sobredispersi√≥n o la subdispersi√≥n.</p>
<p>En un modelo de Poisson, la media y la varianza est√°n directamente relacionadas de la siguiente manera:</p>
<p>Si <span class="math notranslate nohighlight">\(ùëå_ùëñ\)</span> sigue una distribuci√≥n de Poisson con media <span class="math notranslate nohighlight">\(ùúÜ_ùëñ\)</span>:</p>
<div class="math notranslate nohighlight">
\[
Var(ùëå_ùëñ)=ùê∏[ùëå_ùëñ]=ùúÜ_ùëñ‚Äã
\]</div>
<p>Es decir, la varianza y la media son iguales. Esta propiedad, sin embargo, no siempre se cumple cuando se modelan datos reales, especialmente en datos espaciales.</p>
<p>La sobredispersi√≥n ocurre cuando la varianza de los datos es mayor que la media. Es decir, los datos muestran m√°s variabilidad de la que el modelo de Poisson predice. La sobredispersi√≥n indica que el modelo subestima la variabilidad en los datos. Puede ser causada por factores no observados que afectan el proceso, creando cl√∫steres o patrones espaciales. Por ejemplo, si se modela el n√∫mero de deslizamientos en una regi√≥n, pero existen factores locales que var√≠an significativamente dentro de la regi√≥n (como el tipo de suelo o las pr√°cticas de manejo del terreno), la variabilidad observada en los deslizamientos ser√° mayor que la predicha por la simple distribuci√≥n de Poisson.
Los modelos de Poisson no pueden manejar adecuadamente este tipo de situaci√≥n porque asumen una relaci√≥n 1:1 entre la media y la varianza. Cuando hay sobredispersi√≥n, el modelo suele producir errores est√°ndar subestimados, lo que puede llevar a test estad√≠sticos incorrectos y a la identificaci√≥n de relaciones significativas falsas. Una opci√≥n com√∫n para manejar la sobredispersi√≥n es utilizar un modelo de binomial negativo. Este modelo introduce un par√°metro adicional que permite ajustar la varianza de manera independiente de la media.</p>
<p>La subdispersi√≥n ocurre cuando la varianza de los datos es menor que la media. En este caso, los datos presentan menos variabilidad de la que la distribuci√≥n de Poisson predice. La subdispersi√≥n es menos com√∫n que la sobredispersi√≥n en la pr√°ctica, pero puede ocurrir en ciertos contextos donde los eventos est√°n altamente regulados o tienen un patr√≥n regular.
Un ejemplo podr√≠a ser el n√∫mero de √°rboles plantados siguiendo un esquema regular en una regi√≥n o una situaci√≥n en la que la influencia espacial est√° restringida, causando que los eventos ocurran de manera muy controlada y menos variable. Manejar la subdispersi√≥n es menos com√∫n, pero se puede utilizar una reformulaci√≥n del modelo que considere una menor variabilidad. Esto implica ajustar la especificaci√≥n del modelo, por ejemplo, restringiendo el rango de valores posibles para las observaciones. Tambi√©n se podr√≠an utilizar modelos como la regresi√≥n cuasi-Poisson, donde se ajusta la varianza independientemente de la media para modelar la subdispersi√≥n.</p>
<p>El proceso de puntos de Poisson a veces se llama proceso puramente o completamente aleatorio. Este proceso tiene la propiedad de que el n√∫mero de eventos <span class="math notranslate nohighlight">\(N(A)\)</span> en una regi√≥n acotada <span class="math notranslate nohighlight">\(A \in \mathbb{R}^d\)</span> est√° distribuido de manera independiente y uniforme sobre <span class="math notranslate nohighlight">\(A\)</span>. Esto significa que la ubicaci√≥n de un punto no afecta las probabilidades de que otros puntos aparezcan cerca y que no hay regiones donde los eventos sean m√°s propensos a aparecer.</p>
<p>Si un proceso de puntos de Poisson tiene un par√°metro constante, digamos, <span class="math notranslate nohighlight">\(\lambda\)</span>, entonces se llama proceso de <strong>Poisson homog√©neo (o estacionario) (HPP)</strong>. El par√°metro <span class="math notranslate nohighlight">\(\lambda\)</span>, llamado intensidad, est√° relacionado con el n√∫mero esperado (o promedio) de puntos de Poisson que existen en alguna regi√≥n acotada. El par√°metro <span class="math notranslate nohighlight">\(\lambda\)</span> se puede interpretar como el n√∫mero promedio de puntos por alguna unidad de longitud, √°rea o volumen, dependiendo del espacio matem√°tico subyacente, por lo que a veces se llama densidad media.</p>
<p>El HPP es estacionario y los patrones y procesos de puntos espaciales son isotr√≥picos. Es estacionario porque la intensidad es constante y, adem√°s, es isotr√≥pico porque la intensidad es invariante a la rotaci√≥n de <span class="math notranslate nohighlight">\(\mathbb{R}^d\)</span>.</p>
<p>Una generalizaci√≥n del HPP que permite una intensidad no constante <span class="math notranslate nohighlight">\(\lambda\)</span> se llama proceso de <strong>Poisson no-homog√©neo (IPP)</strong>. Tanto el HPP como el IPP asumen que los eventos ocurren de manera independiente y est√°n distribuidos seg√∫n una intensidad dada, <span class="math notranslate nohighlight">\(\lambda\)</span>. La principal diferencia es que el HPP asume que la funci√≥n de intensidad es constante (<span class="math notranslate nohighlight">\(\lambda = \text{const.}\)</span>), mientras que la intensidad de un IPP var√≠a espacialmente (<span class="math notranslate nohighlight">\(\lambda = Z(u)\)</span>).</p>
<p>En el plano <span class="math notranslate nohighlight">\((\mathbb{R}^2)\)</span>, el proceso de puntos de Poisson se conoce como <strong>proceso de Poisson espacial</strong>. En una regi√≥n acotada <span class="math notranslate nohighlight">\(A\)</span> en un plano <span class="math notranslate nohighlight">\((\mathbb{R}^2)\)</span>, con <span class="math notranslate nohighlight">\(N(A)\)</span> siendo el n√∫mero (aleatorio) de puntos <span class="math notranslate nohighlight">\(N\)</span> que existen en la regi√≥n <span class="math notranslate nohighlight">\(A \subset \mathbb{R}^2\)</span>, un proceso de Poisson homog√©neo con par√°metro <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span> describe la probabilidad de que existan <span class="math notranslate nohighlight">\(n\)</span> puntos en <span class="math notranslate nohighlight">\(A\)</span> mediante:</p>
<p><span class="math notranslate nohighlight">\( 
P\{N(A) = n\} = \frac{\lambda^{|A|} (|A|)^n}{n!} e^{-\lambda |A|} 
\)</span></p>
<p>donde <span class="math notranslate nohighlight">\(|A|\)</span> denota el √°rea de <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">poisson</span>

<span class="c1"># Define the parameter (lambda, or average rate of occurrence)</span>
<span class="n">lambda_rate</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Average number of events in an interval</span>

<span class="c1"># Generate a range of values (k) for which we will calculate the probability</span>
<span class="n">k_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>  <span class="c1"># Values of k (number of events)</span>

<span class="c1"># Calculate the probability mass function (PMF) for each k</span>
<span class="n">pmf_values</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k_values</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">lambda_rate</span><span class="p">)</span>

<span class="c1"># Plot the Poisson distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">k_values</span><span class="p">,</span> <span class="n">pmf_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Poisson Distribution (lambda = </span><span class="si">{</span><span class="n">lambda_rate</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of events (k)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/972a97aeee0e60c668407cec4071188e740ee7c4d45dfed634f9aa9e0e0d9a28.png" src="_images/972a97aeee0e60c668407cec4071188e740ee7c4d45dfed634f9aa9e0e0d9a28.png" />
</div>
</div>
<section id="ejemplo-1-de-un-glm-de-poisson-homogeneo">
<h3>Ejemplo 1 de un GLM de Poisson homog√©neo<a class="headerlink" href="#ejemplo-1-de-un-glm-de-poisson-homogeneo" title="Permalink to this heading">#</a></h3>
<p>Supongamos que estamos analizando la cantidad de ‚Äúpuntos calientes‚Äù de incendios forestales en diferentes celdas de una cuadr√≠cula en una regi√≥n forestal. Queremos modelar c√≥mo ciertos factores ambientales afectan el n√∫mero de puntos calientes en cada celda. Los factores considerados son la temperatura media de la celda, la humedad relativa y la densidad de vegetaci√≥n (medida con el √≠ndice NDVI). Utilizaremos un modelo de Poisson para modelar el n√∫mero de puntos calientes en funci√≥n de estas covariables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Librer√≠as necesarias</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="c1"># Crear un conjunto de datos simulado con pandas</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;temperatura&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>  <span class="c1"># Temperatura media en grados Celsius</span>
    <span class="s1">&#39;humedad_relativa&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>  <span class="c1"># Humedad relativa en porcentaje</span>
    <span class="s1">&#39;ndvi&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>  <span class="c1"># NDVI (densi√≥n de vegetaci√≥n, entre 0 y 1)</span>
    <span class="s1">&#39;puntos_calientes&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># N√∫mero de puntos calientes detectados</span>
<span class="p">}</span>

<span class="c1"># Convertir los datos en un DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Describir los primeros datos del DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   temperatura  humedad_relativa      ndvi  puntos_calientes
0    32.865639         23.014581  0.572018                 2
1    21.070668         22.094693  0.401562                 4
2    28.201852         53.069598  0.544974                 2
3    31.505537         46.290717  0.409959                 1
4    30.919173         70.350824  0.617257                 3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ajustar un modelo GLM de Poisson utilizando statsmodels</span>
<span class="c1"># La f√≥rmula describe el modelo: puntos_calientes ~ temperatura + humedad_relativa + ndvi</span>
<span class="n">modelo_poisson</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">glm</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;puntos_calientes ~ temperatura + humedad_relativa + ndvi&quot;</span><span class="p">,</span> 
                         <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> 
                         <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">Poisson</span><span class="p">())</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Resumen del modelo</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modelo_poisson</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 Generalized Linear Model Regression Results                  
==============================================================================
Dep. Variable:       puntos_calientes   No. Observations:                  100
Model:                            GLM   Df Residuals:                       96
Model Family:                 Poisson   Df Model:                            3
Link Function:                    Log   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -184.92
Date:                Sat, 14 Jun 2025   Deviance:                       97.186
Time:                        14:58:09   Pearson chi2:                     85.2
No. Iterations:                     4   Pseudo R-squ. (CS):            0.03179
Covariance Type:            nonrobust                                         
====================================================================================
                       coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------------
Intercept            1.5558      0.429      3.623      0.000       0.714       2.397
temperatura         -0.0024      0.011     -0.223      0.823      -0.024       0.019
humedad_relativa    -0.0047      0.003     -1.426      0.154      -0.011       0.002
ndvi                -0.3842      0.312     -1.232      0.218      -0.995       0.227
====================================================================================
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>El coeficiente para ‚Äútemperatura‚Äù indica el cambio en la tasa esperada de puntos calientes por unidad adicional de temperatura.</p></li>
<li><p>El coeficiente para ‚Äúhumedad_relativa‚Äù indica c√≥mo afecta la humedad relativa a la tasa de ocurrencia de puntos calientes. Si el coeficiente es negativo, una mayor humedad podr√≠a reducir la probabilidad de que ocurran puntos calientes.</p></li>
<li><p>El coeficiente para ‚Äúndvi‚Äù describe el impacto de la densidad de vegetaci√≥n sobre el n√∫mero de puntos calientes.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gr√°fico simple de puntos calientes vs temperatura para ilustrar la correlaci√≥n</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;temperatura&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;puntos_calientes&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperatura Media (Celsius)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;N√∫mero de Puntos Calientes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Puntos Calientes vs Temperatura&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/874dc2d6e04f9101b6dd1c5f18835e4591ec3107e15d926a7a04b628aab61cfc.png" src="_images/874dc2d6e04f9101b6dd1c5f18835e4591ec3107e15d926a7a04b628aab61cfc.png" />
</div>
</div>
<p>Si los coeficientes de ‚Äútemperatura‚Äù y ‚Äúndvi‚Äù son positivos, esto sugiere que a mayor temperatura y mayor densidad de vegetaci√≥n, se incrementa la probabilidad de tener m√°s puntos calientes. Si el coeficiente de ‚Äúhumedad_relativa‚Äù es negativo, indica que un incremento en la humedad relativa reduce el n√∫mero esperado de puntos calientes.</p>
</section>
<section id="ejemplo-2-de-un-glm-de-poisson-homogeneo">
<h3>Ejemplo 2 de un GLM de Poisson homog√©neo<a class="headerlink" href="#ejemplo-2-de-un-glm-de-poisson-homogeneo" title="Permalink to this heading">#</a></h3>
<p>Cualquier modelo estad√≠stico que describa datos que ocurren en puntos localizados en el tiempo, como los tiempos de disparo de neuronas, se denomina modelo de proceso puntual temporal. Aqu√≠, queremos construir un modelo estad√≠stico que describa la distribuci√≥n de probabilidad de los tiempos de espera entre los disparos para una neurona sin un est√≠mulo de conducci√≥n expl√≠cito, en este caso, el modelo deber√≠a caracterizar c√≥mo la distribuci√≥n de los datos depende de las covariables de inter√©s: la posici√≥n del rat√≥n y la direcci√≥n del movimiento.</p>
<p>Un enfoque utilizado para modelar datos enteros positivos es un modelo de Poisson, en el que usamos un par√°metro de tasa, <span class="math notranslate nohighlight">\(\lambda\)</span>, para definir la tasa esperada de disparos en cualquier intervalo de tiempo. Para los datos de inter√©s aqu√≠, ampliamos este concepto definiendo una tasa que var√≠a en el tiempo como una funci√≥n de un conjunto de covariables. Estas covariables son cualquier variable cuya influencia sobre la actividad de disparo deseemos explorar. Nuestras visualizaciones sugieren que las covariables √∫tiles para nuestro modelo incluyen la posici√≥n del rat√≥n y su direcci√≥n de movimiento.</p>
<p>Definamos algunos t√©rminos. Dejemos que <span class="math notranslate nohighlight">\(X(t)\)</span> represente la posici√≥n del rat√≥n en el tiempo <span class="math notranslate nohighlight">\(t\)</span>, y que <span class="math notranslate nohighlight">\(D(t)\)</span> represente la direcci√≥n del movimiento; establecemos <span class="math notranslate nohighlight">\(D(t) = -1\)</span> cuando <span class="math notranslate nohighlight">\(X(t)\)</span> est√° disminuyendo o el rat√≥n est√° detenido, y <span class="math notranslate nohighlight">\(D(t) = +1\)</span> cuando <span class="math notranslate nohighlight">\(X(t)\)</span> est√° aumentando. Dado que estas se√±ales de posici√≥n y direcci√≥n cambian en funci√≥n del tiempo, tambi√©n lo hace la tasa de disparo. Escribimos <span class="math notranslate nohighlight">\(\lambda(t) = f(X(t), D(t))\)</span>, donde <span class="math notranslate nohighlight">\(\lambda(t)\)</span> se llama la funci√≥n de tasa de Poisson, y <span class="math notranslate nohighlight">\(f\)</span> es una funci√≥n que necesitamos para definir el modelo.</p>
<p>¬øQu√© funci√≥n deber√≠amos usar para <span class="math notranslate nohighlight">\(f(X(t), D(t))\)</span>? Queremos algo que capture la relaci√≥n entre las covariables y los disparos, y que sea f√°cil de interpretar. El proceso de encontrar un modelo o conjunto de modelos que sean m√°s consistentes con los datos se llama identificaci√≥n de modelos o selecci√≥n de modelos. T√≠picamente, este es un proceso iterativo en el que proponemos una clase de modelos, encontramos el modelo particular en esa clase que mejor se ajusta a los datos, evaluamos la calidad de ese modelo y decidimos si refinar el modelo a√∫n m√°s o sacar conclusiones del ajuste del modelo. En la pr√°ctica, es una buena idea comenzar con estad√≠sticas descriptivas y visualizaciones de la relaci√≥n entre las covariables y los datos de disparo para seleccionar una clase de modelos de proceso puntual. Para los datos de tren de disparo de inter√©s aqu√≠, nuestras visualizaciones sugieren un modelo donde la dependencia del disparo en la posici√≥n tiene una forma de mont√≠culo (como en el histograma normalizado por ocupaci√≥n) e incorpora la direcci√≥n. Comenzamos con un modelo demasiado simple para fines pedag√≥gicos.</p>
<p>El siguiente es un modelo muy b√°sico inspirado en la regresi√≥n lineal simple:</p>
<div class="math notranslate nohighlight">
\[
\lambda(t) = \beta_0 + \beta_1 X(t)
\]</div>
<p>La idea de la regresi√≥n lineal es expresar una variable de respuesta en el tiempo <span class="math notranslate nohighlight">\(t\)</span> en t√©rminos de variables predictoras, o covariables. Aqu√≠, <span class="math notranslate nohighlight">\(\beta_0\)</span> y <span class="math notranslate nohighlight">\(\beta_1\)</span> son par√°metros desconocidos utilizados para caracterizar una dependencia lineal entre la variable de respuesta <span class="math notranslate nohighlight">\(\lambda(t)\)</span> y la covariable <span class="math notranslate nohighlight">\(X(t)\)</span>. <span class="math notranslate nohighlight">\(\beta_0\)</span> representa la tasa de disparo esperada en <span class="math notranslate nohighlight">\(X(t) = 0\)</span>, y <span class="math notranslate nohighlight">\(\beta_1\)</span> representa el cambio en la tasa de disparo por cada unidad de aumento en la posici√≥n. Este modelo inicial no incluye ninguna dependencia en la direcci√≥n de movimiento del rat√≥n (es decir, no hay t√©rmino <span class="math notranslate nohighlight">\(D(t)\)</span>).</p>
<p>La forma del modelo se parece a una regresi√≥n lineal est√°ndar, lo cual es reconfortante porque existen m√©todos en Python para resolver este tipo de problemas. Sin embargo, los datos observados son eventos de disparo; en tiempo discreto, los datos son conteos de disparos. Una regresi√≥n lineal est√°ndar asume que la distribuci√≥n de los datos, dadas las covariables, es normal. Los conteos de disparos solo pueden tomar valores enteros no negativos, por lo que su distribuci√≥n no puede ser normal. Cuando el n√∫mero de conteos de disparos en cada intervalo de tiempo es muy grande, es posible que la distribuci√≥n de los datos pueda aproximarse por una distribuci√≥n normal, y en este caso, los m√©todos de regresi√≥n simple podr√≠an funcionar. Pero para los datos de disparo de inter√©s aqu√≠, tenemos muy pocos disparos (0 o 1) en cada intervalo de tiempo de 1 ms, por lo que un ajuste de regresi√≥n simple no ser√≠a correcto.</p>
<p>En su lugar, debemos ajustar un modelo de regresi√≥n de Poisson a los datos. Si dejamos que <span class="math notranslate nohighlight">\(Y_i\)</span> sea el n√∫mero de disparos observados en el intervalo <span class="math notranslate nohighlight">\(i\)</span>, entonces bajo el modelo de regresi√≥n de Poisson, <span class="math notranslate nohighlight">\(Y_i\)</span> tiene una distribuci√≥n de Poisson con un par√°metro de media igual a la variable de respuesta <span class="math notranslate nohighlight">\(\lambda(t)\)</span> integrada sobre el intervalo <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>¬øC√≥mo ajustamos el modelo de regresi√≥n de Poisson? Resulta que los modelos de regresi√≥n de Poisson de cierta forma se pueden ajustar de manera eficiente utilizando la teor√≠a de modelos lineales generalizados (GLM). En Python, podemos ajustar este modelo utilizando el paquete <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>. Antes de aplicar esta funci√≥n directamente a los datos, obtengamos una visi√≥n general de las entradas y salidas de la funci√≥n. En Python, consideramos el modelo GLM del paquete <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>. Construiremos un modelo usando:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">GLM</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X_1</span><span class="p">,</span> <span class="n">family</span><span class="p">(</span><span class="n">link</span><span class="p">()))</span>
</pre></div>
</div>
<p>La primera entrada, <span class="math notranslate nohighlight">\(Y\)</span>, es un vector de los conteos de disparos en cada paso de tiempo. En este caso, <span class="math notranslate nohighlight">\(Y\)</span> es el vector <code class="docutils literal notranslate"><span class="pre">spiketrain</span></code> que calculamos anteriormente. La segunda entrada, <span class="math notranslate nohighlight">\(X_1\)</span>, es una matriz de las covariables de las que depende el disparo. El tama√±o de esta matriz es <span class="math notranslate nohighlight">\(n \times p\)</span>, donde <span class="math notranslate nohighlight">\(p\)</span> es el n√∫mero de covariables en el modelo, y <span class="math notranslate nohighlight">\(n\)</span> es el n√∫mero de observaciones. Dado que nuestro modelo est√° dado por <span class="math notranslate nohighlight">\(\lambda(t) = \beta_0 + \beta_1 X(t)\)</span>, a√±adiremos una columna de unos a la matriz de datos <span class="math notranslate nohighlight">\(X\)</span>, para que podamos ajustar la intersecci√≥n <span class="math notranslate nohighlight">\(\beta_0\)</span> a nuestros datos. Por lo tanto, <span class="math notranslate nohighlight">\(X_1\)</span> es una matriz <span class="math notranslate nohighlight">\(n \times 2\)</span>, donde <span class="math notranslate nohighlight">\(n\)</span> es el n√∫mero de puntos de datos (177,761) que representan la posici√≥n del rat√≥n a lo largo de la pista. La tercera entrada indica la distribuci√≥n de los datos de conteo de disparos en <span class="math notranslate nohighlight">\(Y\)</span>. Para un modelo de regresi√≥n de Poisson de datos de conteo de disparos, utilizamos la familia de Poisson. De hecho, para la mayor√≠a de los modelos de conteo de disparos neuronales ajustados utilizando GLM, incluso aquellos que no son procesos de Poisson, utilizamos la distribuci√≥n de Poisson. La entrada <code class="docutils literal notranslate"><span class="pre">family</span></code> se caracteriza por una funci√≥n de enlace entre la tasa de disparo y las covariables. Espec√≠ficamente, si queremos ajustar un modelo de la forma <span class="math notranslate nohighlight">\(\lambda(t) = \exp(\beta_0 + \beta_1 X(t))\)</span>, entonces dir√≠amos que la funci√≥n <span class="math notranslate nohighlight">\(\log(\lambda(t)) = \beta_0 + \beta_1 X(t)\)</span> es la funci√≥n de enlace. Para el Modelo 1, esta es simplemente la funci√≥n identidad. A continuaci√≥n, mostramos una mejor manera de seleccionar esta funci√≥n de enlace.</p>
<p>El atributo <code class="docutils literal notranslate"><span class="pre">params</span></code> de la funci√≥n <code class="docutils literal notranslate"><span class="pre">fit</span></code> es un vector de n√∫meros que representa las estimaciones de m√°xima verosimilitud de los par√°metros del modelo, que para este ejemplo hemos etiquetado como <span class="math notranslate nohighlight">\(\beta_0\)</span> y <span class="math notranslate nohighlight">\(\beta_1\)</span>. Usamos la notaci√≥n con ‚Äúsombrero‚Äù (hat) sobre un par√°metro para representar su estimaci√≥n. La estimaci√≥n de m√°xima verosimilitud de <span class="math notranslate nohighlight">\(\beta_0\)</span> se escribe como <span class="math notranslate nohighlight">\(\hat{\beta}_0\)</span>, y la estimaci√≥n de m√°xima verosimilitud de <span class="math notranslate nohighlight">\(\beta_1\)</span> se escribe como <span class="math notranslate nohighlight">\(\hat{\beta}_1\)</span>. Ahora, usemos esta funci√≥n para ajustar los par√°metros del Modelo 1 a los datos observados de ubicaci√≥n y disparos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/Mark-Kramer/Case-Studies-Python/raw/master/matfiles/spikes-1.mat&#39;</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">open</span><span class="p">(</span><span class="s1">&#39;spikles-1.mat&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1761663
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">loadmat</span><span class="p">(</span><span class="s2">&quot;spikles-1.mat&quot;</span><span class="p">)</span>  
<span class="n">t</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>              
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>             
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>                     
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Position [cm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3843ed459d6f20ac0f1426e73854ded5149ef31b2a4ad6f1dd8f049cea642a52.png" src="_images/3843ed459d6f20ac0f1426e73854ded5149ef31b2a4ad6f1dd8f049cea642a52.png" />
</div>
</div>
<p>El gr√°fico muestra que la rata corre de un lado a otro de manera consistente, realizando aproximadamente 15 pasadas durante los 3 minutos de grabaci√≥n. Tambi√©n observamos que la rata se mueve bastante r√°pido en cada pasada, pero pasa una gran cantidad de tiempo en ambos extremos de la pista (cerca de la posici√≥n 0 cm o 100 cm) antes de girar y continuar.</p>
<p>A continuaci√≥n, nos gustar√≠a graficar la actividad de disparo en relaci√≥n con la trayectoria de movimiento de la rata. Sin embargo, no podemos simplemente graficar el vector X contra el vector spiketimes; estos vectores tienen longitudes diferentes. La longitud de X es la misma que la longitud de t, el n√∫mero total de intervalos de tiempo de 1 ms en la grabaci√≥n (177,761 intervalos de tiempo). La longitud de spiketimes es el n√∫mero total de picos que ocurrieron durante la duraci√≥n de la grabaci√≥n: 220 picos. Por lo tanto, el primer paso para visualizar la actividad de disparo espec√≠fica del lugar es usar spiketimes para crear un nuevo vector, del mismo tama√±o que X, que indique si se produjo un pico en cada intervalo de tiempo. Llamaremos a este vector spiketrain, y contendr√° un 1 para cada intervalo de tiempo donde ocurre un pico y un 0 para cada intervalo de tiempo que no tiene un pico.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spiketimes</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;spiketimes&#39;</span><span class="p">]</span>
<span class="n">n_bins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="c1"># Histogram spikes into bins centered at times t:</span>
<span class="n">spiketrain</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">spiketimes</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">n_bins</span><span class="p">,</span> <span class="nb">range</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">spikeindex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spiketrain</span><span class="o">!=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>     <span class="c1"># Get the spike indices.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>                               <span class="c1"># Plot the position,</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">spikeindex</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">spikeindex</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>  <span class="c1"># ... and the spikes.  </span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [sec]&#39;</span><span class="p">)</span>                     <span class="c1"># Label the axes.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Position [cm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/70414d9cbc6f65650caaf86e4256a42ec341da35a5f54e92e66e1ef91eae6239.png" src="_images/70414d9cbc6f65650caaf86e4256a42ec341da35a5f54e92e66e1ef91eae6239.png" />
</div>
</div>
<p>A partir de la figura anterior, est√° claro que la mayor parte de la actividad de picos ocurre cuando la rata est√° corriendo hacia arriba en la pista, en la direcci√≥n donde X est√° aumentando, en valores de X que van desde unos 50 cm hasta unos 80 cm. No vemos la misma actividad de picos en esta regi√≥n cuando la rata est√° corriendo hacia abajo en la pista, en la direcci√≥n donde X est√° disminuyendo. Algunos picos ocurren en otras ubicaciones, pero estos parecen escasos en comparaci√≥n con el disparo espec√≠fico de lugar en esta regi√≥n.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>                              <span class="c1"># Define spatial bins.</span>
<span class="n">spikehist</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">spikeindex</span><span class="p">],</span> <span class="n">bin_edges</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>           <span class="c1"># Histogram positions @ spikes.</span>
<span class="n">occupancy</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">0.001</span>                 <span class="c1"># Convert occupancy to seconds.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">spikehist</span><span class="o">/</span><span class="n">occupancy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># Plot results as bars.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Position [cm]&#39;</span><span class="p">)</span>                                      <span class="c1"># Label the axes.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Occupancy norm. hist. [spikes/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b2b82d2c98f3e38e23e2b95fc662919e6eaf69f52cf7330b9b402b5a5f16a5a0.png" src="_images/b2b82d2c98f3e38e23e2b95fc662919e6eaf69f52cf7330b9b402b5a5f16a5a0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.genmod.families</span> <span class="kn">import</span> <span class="n">Poisson</span>
<span class="kn">from</span> <span class="nn">statsmodels.genmod.families.links</span> <span class="kn">import</span> <span class="n">identity</span>

<span class="c1"># Create a dataframe of predictors that includes X and a constant term</span>
<span class="n">predictors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Intercept&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">})</span>

<span class="c1"># GLM model with Poisson family and identity link function</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">GLM</span><span class="p">(</span><span class="n">spiketrain</span><span class="p">,</span> <span class="n">predictors</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">Poisson</span><span class="p">(</span><span class="n">identity</span><span class="p">()))</span>
<span class="n">model1_results</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="c1"># Fit model to our data</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">model1_results</span><span class="o">.</span><span class="n">params</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b1:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/evaristizabalg/anaconda3/envs/ml/lib/python3.10/site-packages/statsmodels/genmod/families/links.py:13: FutureWarning: The identity link alias is deprecated. Use Identity instead. The identity link alias will be removed after the 0.15.0 release.
  warnings.warn(
/home/evaristizabalg/anaconda3/envs/ml/lib/python3.10/site-packages/statsmodels/genmod/generalized_linear_model.py:308: DomainWarning: The identity link function does not respect the domain of the Poisson family.
  warnings.warn((f&quot;The {type(family.link).__name__} link function &quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b1:
Intercept   -0.000097
X            0.000027
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Inicialmente, es posible que notes que Python emite una advertencia en la l√≠nea de comandos indicando que este modelo‚Äîparticularmente la funci√≥n de enlace de identidad‚Äîpuede ser inapropiado. Ignoraremos esta advertencia e intentaremos interpretar las estimaciones de los par√°metros resultantes. El primero de estos valores es la estimaci√≥n de m√°xima verosimilitud para <span class="math notranslate nohighlight">\(\beta_0\)</span>. Si creemos que este modelo es preciso, podr√≠amos interpretar este par√°metro como indicativo de que la tasa de disparo esperada en la posici√≥n <span class="math notranslate nohighlight">\(X(t) = 0\)</span> es de <span class="math notranslate nohighlight">\(-0.097\)</span> picos por milisegundo, o aproximadamente <span class="math notranslate nohighlight">\(-0.097\)</span> picos por segundo, y que a medida que la rata se mueve en la direcci√≥n positiva, la tasa de disparo aumenta en <span class="math notranslate nohighlight">\(\beta_1\)</span> picos por segundo por cada cent√≠metro que la rata se mueve.</p>
<p>Este resultado deber√≠a levantar algunas se√±ales de advertencia de inmediato. El hecho de que la tasa de disparo sea negativa indica que el modelo se vuelve ininterpretable para los valores observados de <span class="math notranslate nohighlight">\(X(t)\)</span>. Esto sugiere un problema importante con el Modelo 1: la tasa de disparo es negativa, lo que motiva cambios en la funci√≥n de enlace del modelo. Para visualizar mejor la calidad de este modelo, podemos comparar la dependencia que define entre la posici√≥n y la tasa de disparo con el histograma normalizado por ocupaci√≥n que calculamos anteriormente. En este caso, utilizamos las posiciones definidas por los intervalos del histograma y calculamos la tasa de disparo modelada en estos puntos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">spikehist</span><span class="o">/</span><span class="n">occupancy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>    <span class="c1"># Plot results as bars.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,(</span><span class="n">b1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">bins</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
     <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Model spike rate&quot;</span><span class="p">)</span>             <span class="c1"># Plot model.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Position [cm]&#39;</span><span class="p">)</span>                    <span class="c1"># Label the axes.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Occupancy norm. hist. [spikes/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;b1 = [</span><span class="si">{0[0]:.4}</span><span class="s2">, </span><span class="si">{0[1]:.4}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/27981b044f38b90d2b5989db673836a56584947c3eb10d0c28c8d9c5d2a3a2b2.png" src="_images/27981b044f38b90d2b5989db673836a56584947c3eb10d0c28c8d9c5d2a3a2b2.png" />
</div>
</div>
<p>Vemos que la tasa de disparo del modelo captura algunas caracter√≠sticas del disparo observado, por ejemplo, el hecho de que la tasa de disparo aumenta a medida que la rata se mueve desde la posici√≥n <span class="math notranslate nohighlight">\(x = 0\)</span> hacia la posici√≥n <span class="math notranslate nohighlight">\(x = 60\)</span>. Pero el modelo no capta gran parte de la estructura, por ejemplo, el hecho de que la tasa de disparo no cambia linealmente con la posici√≥n y comienza a disminuir cuando la posici√≥n de la rata supera los <span class="math notranslate nohighlight">\(x = 70\)</span>. Esto sugiere un segundo problema con este modelo: la forma de la relaci√≥n entre la posici√≥n y la tasa de disparo es incorrecta.</p>
<p>Concluimos que nuestra propuesta inicial, el Modelo 1, no representa bien los datos. Por lo tanto, refinemos el modelo para abordar los problemas identificados. Primero, elijamos una funci√≥n de enlace que sea m√°s apropiada para el modelado de procesos puntuales. Nos gustar√≠a una funci√≥n que asegure que la funci√≥n de tasa sea no negativa y que sea f√°cil de ajustar. La teor√≠a del modelado lineal generalizado sugiere una funci√≥n en particular: el enlace logar√≠tmico. Establecemos que el logaritmo de la tasa de disparo sea una funci√≥n lineal de las covariables. Si mantenemos la posici√≥n como la √∫nica covariable, esto conduce a un modelo de la forma:</p>
<div class="math notranslate nohighlight">
\[
\log(\lambda(t)) = \beta_0 + \beta_1 X(t)
\]</div>
<p>o, de manera equivalente,</p>
<div class="math notranslate nohighlight">
\[
\lambda(t) = \exp(\beta_0 + \beta_1 X(t))
\]</div>
<p>Esta funci√≥n de enlace se llama el enlace can√≥nico para datos de Poisson. Tiene una serie de propiedades atractivas. Como se deseaba, asegura que la funci√≥n de tasa sea positiva.</p>
<p><strong>P:</strong> Considera la expresi√≥n para <span class="math notranslate nohighlight">\(\lambda(t)\)</span> arriba. ¬øPor qu√© <span class="math notranslate nohighlight">\(\lambda(t)\)</span> debe ser siempre positiva?</p>
<p>La elecci√≥n de un enlace logar√≠tmico tambi√©n asegura que la verosimilitud de los datos sea c√≥ncava con respecto a los par√°metros del modelo. Esto significa que la verosimilitud solo tiene un valor m√°ximo local, que es la estimaci√≥n de m√°xima verosimilitud (ML). Tambi√©n se puede demostrar que, en muchos casos, los estimadores de los par√°metros ser√°n asint√≥ticamente normales, lo que nos permitir√° construir intervalos de confianza y hacer declaraciones de significancia sobre ellos [Kass, Eden &amp; Brown, 2014].</p>
<p>Para ajustar el Modelo 2 en Python, usamos el mismo modelo que antes pero reemplazamos la funci√≥n de enlace con <span class="math notranslate nohighlight">\(\log\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">GLM</span><span class="p">(</span><span class="n">spiketrain</span><span class="p">,</span> <span class="n">predictors</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">Poisson</span><span class="p">())</span> <span class="c1"># GLM model with Poisson family and log link function</span>
<span class="n">model2_results</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="c1"># Fit model to our data</span>
<span class="n">b2</span> <span class="o">=</span> <span class="n">model2_results</span><span class="o">.</span><span class="n">params</span>    <span class="c1"># Get the predicted coefficient vector</span>
</pre></div>
</div>
</div>
</div>
<p>De hecho, si omitimos el nombre de la funci√≥n de enlace en la rutina <code class="docutils literal notranslate"><span class="pre">sm.GLM</span></code>, esta usar√° autom√°ticamente el enlace can√≥nico para la distribuci√≥n seleccionada. Dado que el enlace logar√≠tmico es can√≥nico para datos de Poisson, simplemente podemos ejecutar los comandos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">GLM</span><span class="p">(</span><span class="n">spiketrain</span><span class="p">,</span> <span class="n">predictors</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">Poisson</span><span class="p">())</span>  <span class="c1"># GLM model with Poisson family, omitting link function</span>
<span class="n">model2_results</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>  <span class="c1"># Fit model to our data</span>
<span class="n">b2</span> <span class="o">=</span> <span class="n">model2_results</span><span class="o">.</span><span class="n">params</span>     <span class="c1"># Get the predicted coefficient vector</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept   -7.438887
X            0.012943
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Esta vez, encontramos que Python no emite una advertencia sobre la posible inapropiedad de la funci√≥n de enlace. La inspecci√≥n de los valores estimados de los par√°metros revela <span class="math notranslate nohighlight">\(b_2 = [-7.43888719, 0.01294342]\)</span>. Estos valores son marcadamente diferentes de los valores de par√°metros <span class="math notranslate nohighlight">\(b_1\)</span> encontrados usando el Modelo 1. La raz√≥n de esta diferencia es que la forma del modelo tiene un impacto importante en la interpretaci√≥n de los valores de los par√°metros. A continuaci√≥n, discutimos la interpretaci√≥n de estos valores de los par√°metros en detalle.</p>
<p>Examinemos el ajuste del modelo m√°s de cerca. Cuando <span class="math notranslate nohighlight">\(x = 0\)</span>, la tasa de disparo bajo el Modelo 2 es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\lambda(t) &amp;= \exp(\beta_0 + \beta_1 \times 0) \\
           &amp;= \exp(\beta_0) \\
           &amp;= 0.0006\text{ spikes/ms} \\
           &amp;= 0.6 \text{ spikes/s}
\end{align}
\end{split}\]</div>
<p>donde hemos utilizado el valor <span class="math notranslate nohighlight">\(b_2[0]\)</span>. Si el rat√≥n se mueve de la posici√≥n <span class="math notranslate nohighlight">\(x = 0\)</span> a <span class="math notranslate nohighlight">\(x = 1\)</span>, la tasa de disparo se convierte en:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}\lambda(t) &amp;= \exp(\beta_0 + \beta_1 √ó 1) \\
  &amp;= \exp(\beta_0 + \beta_1)\\
  &amp;= \exp(\beta_0)\exp(\beta_1)\\
  &amp;= 1.013 \exp(\beta_0),\end{align}
\end{split}\]</div>
<p>donde hemos utilizado el valor <span class="math notranslate nohighlight">\(b_2[1]\)</span>. Es decir, un aumento de 1 cm en la posici√≥n incrementa la tasa de disparo en un 1.3%. Debido a la funci√≥n de enlace, la posici√≥n ahora tiene un efecto multiplicativo en lugar de aditivo sobre la tasa de disparo. En lugar de sumar a la tasa de disparo, cada aumento de posici√≥n conduce a una modulaci√≥n multiplicativa de la tasa de disparo, con un incremento de aproximadamente un 1% por cm. Veamos c√≥mo se ve este modelo compar√°ndolo con el histograma normalizado por ocupaci√≥n de los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">spikehist</span><span class="o">/</span><span class="n">occupancy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>    <span class="c1"># Plot results as bars.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">bins</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model spike rate&#39;</span><span class="p">)</span>             <span class="c1"># Plot model.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Position [cm]&#39;</span><span class="p">)</span>                    <span class="c1"># Label the axes.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Occupancy norm. hist. [spikes/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/93d02baa10681e62f5b1a84c5eba3d884b6a4de1230b4a41757489195e2a822c.png" src="_images/93d02baa10681e62f5b1a84c5eba3d884b6a4de1230b4a41757489195e2a822c.png" />
</div>
</div>
<p>La inspecci√≥n visual sugiere que hemos resuelto un problema: la tasa de disparo ya no es negativa en ning√∫n lugar. Sin embargo, el ajuste del modelo a√∫n no concuerda con la estructura observada en el histograma normalizado por ocupaci√≥n. Hemos mejorado la funci√≥n de enlace, pero usar solo la posici√≥n como covariable lleva a una tasa que es una funci√≥n exponencial de la posici√≥n del rat√≥n.</p>
<p>Hay muchas variables que podr√≠amos considerar agregar a este modelo, pero ¬øqu√© variables podr√≠amos a√±adir para capturar mejor la dependencia entre la tasa de disparo y la posici√≥n, en particular? Una idea podr√≠a ser incluir t√©rminos no lineales, como el cuadrado del valor de la posici√≥n.</p>
</section>
</section>
<section id="modelo-binomial-negativo">
<h2>Modelo Binomial Negativo<a class="headerlink" href="#modelo-binomial-negativo" title="Permalink to this heading">#</a></h2>
<p>La regresi√≥n binomial negativa es un modelo de regresi√≥n utilizado para datos de conteo donde la varianza excede la media, un fen√≥meno conocido como sobredispersi√≥n.</p>
<p>Es una extensi√≥n de la regresi√≥n de Poisson, que relaja el supuesto de igualdad entre media y varianza, permitiendo as√≠ un modelado m√°s realista en contextos donde los eventos presentan alta variabilidad.</p>
<p><span class="math notranslate nohighlight">\(y·µ¢ ~ NegBin(Œº·µ¢, Œ∏)\)</span></p>
<p>donde:</p>
<ul class="simple">
<li><p>ùúáùëñ es la media esperada para la observaci√≥n ùëñ</p></li>
<li><p>ùúÉ es el par√°metro de dispersi√≥n</p></li>
</ul>
<p>La funci√≥n de enlace es:</p>
<p><span class="math notranslate nohighlight">\(log(Œº·µ¢) = Œ≤‚ÇÄ + Œ≤‚ÇÅx‚ÇÅ·µ¢ + Œ≤‚ÇÇx‚ÇÇ·µ¢ + ... + Œ≤‚Çöx‚Çö·µ¢\)</span></p>
<p>La varianza bajo la binomial negativa es:</p>
<p><span class="math notranslate nohighlight">\(Var(y·µ¢) = Œº·µ¢ + Œº·µ¢¬≤ / Œ∏\)</span></p>
<p>La dsitribuci√≥n Binomial y la Binomial negativa se relacionan en ambas derivan de ensayos Bernoulli, el cual es un experimento con dos resultados: √©xito (1) o fracaso (0), con probabilidad ùëù.</p>
<ul class="simple">
<li><p>Distribuci√≥n binomial: cuenta cu√°ntos √©xitos hay en ùëõ ensayos con probabilidad fija ùëù.</p></li>
<li><p>Distribuci√≥n binomial negativa: cuenta cu√°ntos fracasos ocurren antes de alcanzar un n√∫mero fijo de √©xitos ùëü (o viceversa, seg√∫n la parametrizaci√≥n).</p></li>
</ul>
<p>Ambas son distribuciones de conteo discreto y ambas modelan variables aleatorias enteras y no negativas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Par√°metros del experimento</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span>  <span class="c1"># Probabilidad de √©xito (sacar un 6)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">5</span>    <span class="c1"># N√∫mero de √©xitos deseados</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Simular lanzamientos hasta obtener r √©xitos</span>
<span class="n">lanzamientos</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">exitos</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">exitos</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">:</span>
    <span class="n">dado</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="n">lanzamientos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dado</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dado</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">exitos</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Convertir a array</span>
<span class="n">lanzamientos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lanzamientos</span><span class="p">)</span>
<span class="n">n_lanzamientos</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lanzamientos</span><span class="p">)</span>
<span class="n">fallos</span> <span class="o">=</span> <span class="n">n_lanzamientos</span> <span class="o">-</span> <span class="n">r</span>

<span class="c1"># Visualizar la secuencia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">6</span> <span class="k">else</span> <span class="s1">&#39;gray&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lanzamientos</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_lanzamientos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n_lanzamientos</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;N√∫mero de lanzamiento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lanzamientos hasta obtener </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2"> √©xitos (seis): </span><span class="si">{</span><span class="n">n_lanzamientos</span><span class="si">}</span><span class="s2"> lanzamientos totales, </span><span class="si">{</span><span class="n">fallos</span><span class="si">}</span><span class="s2"> fallos&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3cf43e71e7e21787594ae30389c0dbf514d8b32004dd25d6ee0a4e432ae97a12.png" src="_images/3cf43e71e7e21787594ae30389c0dbf514d8b32004dd25d6ee0a4e432ae97a12.png" />
</div>
</div>
<p>Aqu√≠ tienes la simulaci√≥n visual de los lanzamientos de dado:</p>
<ul class="simple">
<li><p>Los puntos verdes representan los √©xitos (donde sali√≥ un 6).</p></li>
<li><p>Los grises son fallos (cualquier otro n√∫mero).</p></li>
</ul>
<p>En este experimento, se necesitaron 21 lanzamientos para obtener 5 veces un 6, con 16 fallos intercalados. Esto ilustra perfectamente el concepto de la distribuci√≥n binomial negativa: modelar cu√°ntos ensayos (o fracasos) se requieren antes de alcanzar un n√∫mero fijo de √©xitos no consecutivos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Repetir el experimento muchas veces</span>
<span class="n">n_repeticiones</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">resultados</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_repeticiones</span><span class="p">):</span>
    <span class="n">exitos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">lanzamientos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">exitos</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">:</span>
        <span class="n">dado</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">lanzamientos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">dado</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">exitos</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">fallos</span> <span class="o">=</span> <span class="n">lanzamientos</span> <span class="o">-</span> <span class="n">r</span>
    <span class="n">resultados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fallos</span><span class="p">)</span>

<span class="c1"># Visualizar la distribuci√≥n de fallos hasta obtener r √©xitos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">resultados</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribuci√≥n de fallos antes de obtener </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2"> √©xitos (Binomial Negativa)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;N√∫mero de fallos antes de obtener 5 seis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Densidad&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ed67ba6f96557d579dcbe0064190349c8228c317f4e8ad100d71cc7156f2d32e.png" src="_images/ed67ba6f96557d579dcbe0064190349c8228c317f4e8ad100d71cc7156f2d32e.png" />
</div>
</div>
<p>Aqu√≠ tienes la distribuci√≥n emp√≠rica del n√∫mero de fallos antes de obtener 5 √©xitos (es decir, 5 veces un 6):</p>
<p>Tiene forma asim√©trica (cola larga a la derecha), caracter√≠stica de la binomial negativa.</p>
<p>En promedio, se necesitan m√°s de 20 lanzamientos (fallos + √©xitos) para lograrlo, porque el 6 solo tiene una probabilidad de 1/6.</p>
<p>Esto muestra c√≥mo la binomial negativa captura la variabilidad natural en procesos con baja probabilidad de √©xito y repeticiones aleatorias.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">nbinom</span>

<span class="c1"># Valores posibles de fallos</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Par√°metros de la binomial negativa:</span>
<span class="c1"># r = n√∫mero de √©xitos deseados</span>
<span class="c1"># p = probabilidad de √©xito por ensayo</span>
<span class="c1"># En scipy, nbinom(k; r, p) da la probabilidad de k fallos antes de r √©xitos</span>
<span class="n">pmf_vals</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># Gr√°fico comparativo</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">resultados</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Simulaci√≥n&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">pmf_vals</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Distribuci√≥n te√≥rica (NB)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribuci√≥n de fallos antes de </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2"> √©xitos (comparaci√≥n simulaci√≥n vs. te√≥rica)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;N√∫mero de fallos&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Densidad&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c0e4f58fc3dbdf3001d7dbba20d0a42a02ac08397254f950f4d7c6c62d4bf7c3.png" src="_images/c0e4f58fc3dbdf3001d7dbba20d0a42a02ac08397254f950f4d7c6c62d4bf7c3.png" />
</div>
</div>
<p>Aqu√≠ puedes ver la comparaci√≥n entre la simulaci√≥n y la distribuci√≥n te√≥rica binomial negativa:</p>
<p>La histograma gris representa los resultados de nuestras 10,000 simulaciones.</p>
<p>La l√≠nea roja es la funci√≥n de masa de probabilidad (PMF) te√≥rica para la distribuci√≥n binomial negativa con ùëü=5, ùëù=1/6.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Repetir el an√°lisis con distintos valores de p y r fijos (5)</span>
<span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">max_fallos</span> <span class="o">=</span> <span class="mi">60</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ps</span><span class="p">):</span>
    <span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_fallos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pmf_vals</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_val</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">pmf_vals</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Binomial Negativa (r=</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p_val</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;N√∫mero de fallos antes de 5 √©xitos&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Densidad&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3b05e72320f31ba11fc7fc2d4612a4ee2a07a199c7535f3b4c8f934b29ebfc0b.png" src="_images/3b05e72320f31ba11fc7fc2d4612a4ee2a07a199c7535f3b4c8f934b29ebfc0b.png" />
</div>
</div>
<p>Aqu√≠ puedes ver c√≥mo cambia la forma de la distribuci√≥n binomial negativa al variar la probabilidad de √©xito ùëù:</p>
<ul class="simple">
<li><p>Cuando ùëù=0.1 (√©xito poco probable), la distribuci√≥n es m√°s dispersa, con una cola muy larga: se necesitan muchos intentos.</p></li>
</ul>
<p>üîπ Cuando ùëù=0.3, la distribuci√≥n se vuelve m√°s concentrada: los 5 √©xitos ocurren con menos fallos.</p>
<p>üîπ Cuando ùëù=0.5, la distribuci√≥n se vuelve a√∫n m√°s compacta: los √©xitos son frecuentes.</p>
<p>Esto muestra c√≥mo la probabilidad de √©xito controla la forma y la dispersi√≥n de la binomial negativa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mantener p fijo y variar r (n√∫mero de √©xitos deseados)</span>
<span class="n">p_fixed</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">rs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">max_fallos</span> <span class="o">=</span> <span class="mi">60</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rs</span><span class="p">):</span>
    <span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_fallos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">pmf_vals</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">r_val</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_fixed</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">pmf_vals</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Binomial Negativa (r=</span><span class="si">{</span><span class="n">r_val</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p_fixed</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;N√∫mero de fallos antes de </span><span class="si">{r_val}</span><span class="s2"> √©xitos&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Densidad&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/606ba0a9c9d8b1af775a84974043cd3e883fb63e53655fd92db97c23e590df47.png" src="_images/606ba0a9c9d8b1af775a84974043cd3e883fb63e53655fd92db97c23e590df47.png" />
</div>
</div>
<p>Aqu√≠ puedes ver c√≥mo afecta el n√∫mero de √©xitos deseado ùëü a la forma de la distribuci√≥n binomial negativa, manteniendo la probabilidad de √©xito fija en
ùëù=0.3:</p>
<p>‚úÖ Cuando ùëü=2: la distribuci√≥n es m√°s estrecha y sesgada, porque solo necesitas pocos √©xitos ‚Üí menos variabilidad.</p>
<p>‚úÖ Cuando ùëü=5: la curva se ensancha y desplaza hacia la derecha.</p>
<p>‚úÖ Cuando ùëü=10: se vuelve a√∫n m√°s sim√©trica y extendida: necesitas m√°s √©xitos, as√≠ que se acumulan m√°s fallos.</p>
<p>En resumen: A mayor ùëü, m√°s ensayos y mayor dispersi√≥n. A menor ùëù, mayor varianza.</p>
<section id="ejemplo">
<h3>Ejemplo<a class="headerlink" href="#ejemplo" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulaci√≥n de datos de conteo con sobredispersi√≥n</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">pendiente</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">elevacion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Coeficientes del modelo</span>
<span class="n">beta_0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span>
<span class="n">beta_1</span> <span class="o">=</span> <span class="mf">0.04</span>   <span class="c1"># efecto de pendiente</span>
<span class="n">beta_2</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># efecto de elevaci√≥n</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mf">1.5</span>     <span class="c1"># par√°metro de dispersi√≥n (m√°s dispersi√≥n)</span>

<span class="c1"># Simular √°rea (por ejemplo, en km¬≤)</span>
<span class="n">area_km2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># √°reas entre 1 y 10 km¬≤</span>
<span class="n">log_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">area_km2</span><span class="p">)</span>  <span class="c1"># offset en escala log</span>

<span class="c1"># Media esperada</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">beta_0</span> <span class="o">+</span> <span class="n">beta_1</span> <span class="o">*</span> <span class="n">pendiente</span> <span class="o">+</span> <span class="n">beta_2</span> <span class="o">*</span> <span class="n">elevacion</span> <span class="o">+</span> <span class="n">log_area</span><span class="p">)</span>

<span class="c1"># Generar datos de respuesta</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">/</span> <span class="p">(</span><span class="n">theta</span> <span class="o">+</span> <span class="n">mu</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="c1"># DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;pendiente&quot;</span><span class="p">:</span> <span class="n">pendiente</span><span class="p">,</span>
    <span class="s2">&quot;elevacion&quot;</span><span class="p">:</span> <span class="n">elevacion</span><span class="p">,</span>
    <span class="s2">&quot;area_km2&quot;</span> <span class="p">:</span> <span class="n">area_km2</span><span class="p">,</span>
    <span class="s2">&quot;log_area&quot;</span> <span class="p">:</span> <span class="n">log_area</span><span class="p">,</span>
    <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ajustar modelo binomial negativa</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;pendiente&quot;</span><span class="p">,</span> <span class="s2">&quot;elevacion&quot;</span><span class="p">]])</span>
<span class="n">model_nb</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">GLM</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">X</span><span class="p">,</span>
                         <span class="n">family</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">NegativeBinomial</span><span class="p">(),</span>
                         <span class="n">offset</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;log_area&quot;</span><span class="p">])</span>
<span class="n">results_nb</span> <span class="o">=</span> <span class="n">model_nb</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;mu_pred&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;log_area&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/evaristizabalg/anaconda3/envs/ml/lib/python3.10/site-packages/statsmodels/genmod/families/family.py:1367: ValueWarning: Negative binomial dispersion parameter alpha not set. Using default value alpha=1.0.
  warnings.warn(&quot;Negative binomial dispersion parameter alpha not &quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualizaci√≥n en 3D (opcional)</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pendiente&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;elevacion&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observado&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pendiente&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;elevacion&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;mu_pred&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicci√≥n NB&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Pendiente (¬∞)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Elevaci√≥n (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;N√∫mero de eventos&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Regresi√≥n binomial negativa con dos covariables&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/231b0e0bd26ee2b1b1a410d38fcfad9491d0295a38a40683a75a9099d8e39db4.png" src="_images/231b0e0bd26ee2b1b1a410d38fcfad9491d0295a38a40683a75a9099d8e39db4.png" />
</div>
</div>
</section>
</section>
<section id="modelo-de-ceros-inflados">
<h2>Modelo de Ceros Inflados<a class="headerlink" href="#modelo-de-ceros-inflados" title="Permalink to this heading">#</a></h2>
<p>Los modelos de conteo cl√°sicos como Poisson o binomial negativa suponen que los ceros ocurren como parte del proceso natural. Pero en muchos contextos reales (como deslizamientos), hay m√°s ceros de los que esos modelos predicen, por ejemplo:</p>
<ul class="simple">
<li><p>Celdas donde realmente no hay condiciones f√≠sicas para deslizamientos (ceros estructurales).</p></li>
<li><p>Celdas donde s√≠ podr√≠a haber, pero no ocurrieron durante el periodo observado (ceros aleatorios).</p></li>
</ul>
<p>En esos casos, usamos modelos inflados en ceros, que asumen que algunos ceros provienen de un proceso separado.</p>
<p>El modelo ZINB combina:</p>
<ul class="simple">
<li><p>Una parte binaria (modelo log√≠stico) que predice la probabilidad de estar en el grupo ‚Äúsiempre cero‚Äù.</p></li>
<li><p>Una parte de conteo (binomial negativa) que modela el n√∫mero de eventos si no est√° en el grupo siempre cero.</p></li>
</ul>
<section id="id1">
<h3>Ejemplo<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.discrete.count_model</span> <span class="kn">import</span> <span class="n">ZeroInflatedNegativeBinomialP</span>

<span class="c1"># 1. Simular datos reales</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">tiempo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># ejemplo: 100 a√±os o meses</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># predictor temporal (puede ser SPI, pendiente promedio, etc.)</span>

<span class="c1"># Modelo real</span>
<span class="n">beta_0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">beta_1</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">beta_0</span> <span class="o">+</span> <span class="n">beta_1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">nbinom</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">/</span> <span class="p">(</span><span class="n">theta</span> <span class="o">+</span> <span class="n">mu</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">theta</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">nbinom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="c1"># 2. Introducir falsos ceros (subregistro): 25% de los y_true &gt; 0 se vuelven 0</span>
<span class="n">y_obs</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">y_obs</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># 3. Preparar datos</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;tiempo&quot;</span><span class="p">:</span> <span class="n">tiempo</span><span class="p">,</span>
    <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
    <span class="s2">&quot;y_obs&quot;</span><span class="p">:</span> <span class="n">y_obs</span><span class="p">,</span>
    <span class="s2">&quot;y_true&quot;</span><span class="p">:</span> <span class="n">y_true</span><span class="p">,</span>
    <span class="s2">&quot;falso_cero&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">y_obs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1"># 4. Ajustar modelo ZINB (modelo de correcci√≥n)</span>
<span class="n">exog</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">])</span>  <span class="c1"># incluye intercepto</span>
<span class="n">zinb_model</span> <span class="o">=</span> <span class="n">ZeroInflatedNegativeBinomialP</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_obs&quot;</span><span class="p">],</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">exog_infl</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">inflation</span><span class="o">=</span><span class="s2">&quot;logit&quot;</span><span class="p">)</span>
<span class="n">zinb_result</span> <span class="o">=</span> <span class="n">zinb_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;bfgs&quot;</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># 5. Estimar media esperada corregida</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;mu_pred&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zinb_result</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>

<span class="c1"># 6. Visualizar serie original, observada y corregida</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;tiempo&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_true&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Valor real (y_true)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;tiempo&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_obs&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Valor observado (con omisi√≥n)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;tiempo&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;mu_pred&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Valor estimado corregido (ZINB)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Tiempo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;N√∫mero de eventos&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correcci√≥n de series con omisi√≥n usando modelo ZINB&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8e7c68bd2ad03a309a88d5d3c636d0396364a23e2f0a4743fc25d304a8587413.png" src="_images/8e7c68bd2ad03a309a88d5d3c636d0396364a23e2f0a4743fc25d304a8587413.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="03_PointPattern.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Patr√≥n de puntos</p>
      </div>
    </a>
    <a class="right-next"
       href="06_Coropleta.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Visualizaci√≥n de datos discretos</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-logistica">Modelo de Regresi√≥n Log√≠stica</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-con-statsmodels">Ejemplo con Statsmodels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-con-sklearn">Ejemplo con Sklearn</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-poisson">Modelo de Poisson</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-1-de-un-glm-de-poisson-homogeneo">Ejemplo 1 de un GLM de Poisson homog√©neo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-2-de-un-glm-de-poisson-homogeneo">Ejemplo 2 de un GLM de Poisson homog√©neo</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-binomial-negativo">Modelo Binomial Negativo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo">Ejemplo</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-ceros-inflados">Modelo de Ceros Inflados</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Ejemplo</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Edier V. Aristiz√°bal G.
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>